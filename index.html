<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>141VYBZ Radio</title>
</head>
<body>
  <h1>ðŸŽ§ Welcome to 141VYBZ Live Radio</h1>
  <p>Streaming the hottest vibes live, right now.</p>

  <script>
    const ws = new WebSocket(location.origin.replace(/^http/, 'ws') + '/stream');
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    ws.binaryType = 'arraybuffer';

    ws.onmessage = (msg) => {
      const buffer = msg.data;
      const int16 = new Int16Array(buffer);
      const float32 = new Float32Array(int16.length);

      for (let i = 0; i < int16.length; i++) {
        float32[i] = int16[i] / 0x7fff;
      }

      const audioBuffer = audioCtx.createBuffer(1, float32.length, audioCtx.sampleRate);
      audioBuffer.copyToChannel(float32, 0);

      const source = audioCtx.createBufferSource();
      source.buffer = audioBuffer;
      source.connect(audioCtx.destination);
      source.start();
    };
  </script>
</body>
</html>
